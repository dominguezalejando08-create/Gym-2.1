<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MONOS FIT | LifeStyle</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap');

        :root {
            --primary: #4f46e5;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --accent: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
            --radius: 20px;
        }

        body {
            margin: 0;
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            padding-bottom: 50px;
        }

        /* --- Header --- */
        header {
            background: white;
            padding: 40px 20px;
            text-align: center;
            border-bottom: 1px solid #e2e8f0;
        }
        header h1 { margin: 0; font-size: 2rem; font-weight: 800; color: var(--primary); letter-spacing: -1px; }
        #frase-container { margin-top: 10px; color: var(--text-light); font-size: 0.95rem; font-weight: 500; transition: opacity 0.5s; }

        /* --- Nav --- */
        nav {
            display: flex;
            background: white;
            position: sticky;
            top: 0;
            z-index: 1000;
            overflow-x: auto;
            border-bottom: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.02);
        }
        nav button {
            flex: 1; min-width: 90px; border: none; background: none; padding: 18px 10px;
            font-weight: 600; font-size: 0.85rem; color: var(--text-light); cursor: pointer; transition: 0.3s;
        }
        nav button.active { color: var(--primary); border-bottom: 3px solid var(--primary); }

        /* --- Layout --- */
        section { display: none; max-width: 700px; margin: 25px auto; padding: 0 20px; animation: fadeInUp 0.5s ease; }
        section.active { display: block; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        .card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border: 1px solid #f1f5f9;
        }

        /* --- Ejercicios (No se contraen) --- */
        .ex-list { display: flex; flex-direction: column; gap: 15px; }
        .ex-card {
            display: flex; align-items: center; gap: 15px; padding: 15px;
            background: #f8fafc; border-radius: 15px; border: 1px solid #e2e8f0;
        }
        .ex-img { width: 70px; height: 70px; border-radius: 12px; object-fit: cover; background: #fff; border: 1px solid #eee; }
        
        /* --- Inputs & Buttons --- */
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.85rem; }
        input, select {
            width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #cbd5e1;
            font-family: inherit; font-size: 1rem; transition: 0.3s;
        }
        input:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1); }

        .btn {
            padding: 12px 20px; border-radius: 12px; border: none; font-weight: 700;
            cursor: pointer; display: inline-flex; align-items: center; gap: 8px; transition: 0.3s;
        }
        .btn-main { background: var(--primary); color: white; width: 100%; justify-content: center; }
        .btn-ghost { background: #f1f5f9; color: var(--text); }
        .btn:active { transform: scale(0.96); }

        /* --- Macros --- */
        .macro-box { text-align: center; padding: 15px; border-radius: 15px; color: white; }

        /* --- Table --- */
        .table-wrap { overflow-x: auto; border-radius: 15px; }
        table { width: 100%; border-collapse: collapse; background: white; }
        th { background: #f8fafc; padding: 15px; text-align: left; font-size: 0.8rem; }
        td { padding: 15px; border-top: 1px solid #f1f5f9; font-size: 0.9rem; }

        #timer-pill {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: var(--text); color: white; padding: 12px 30px;
            border-radius: 50px; font-weight: 800; display: none; z-index: 2000; box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

<header>
    <h1>MONOS FIT</h1>
    <div id="frase-container">Prep√°rate para el √©xito</div>
</header>

<nav>
    <button class="active" data-section="entrenar">Entrenar</button>
    <button data-section="rutina">Rutina</button>
    <button data-section="dieta">Dieta</button>
    <button data-section="progreso">Evoluci√≥n</button>
    <button data-section="ajustes">Ajustes</button>
</nav>

<section id="entrenar" class="active">
    <h2>üöÄ Entrenamiento de Hoy</h2>
    <label>Selecciona tu d√≠a: 
        <select id="selectDiaHoy" onchange="renderEntrenamiento()">
            <option value="1">D√≠a 1</option><option value="2">D√≠a 2</option>
            <option value="3">D√≠a 3</option><option value="4">D√≠a 4</option>
            <option value="5">D√≠a 5</option><option value="6">D√≠a 6</option>
        </select>
    </label>
    <div id="listaEntrenamiento" class="ex-list" style="margin-top:20px"></div>
</section>

<section id="rutina">
    <div class="card">
        <h3>‚úèÔ∏è Crear Ejercicio</h3>
        <div class="input-group">
            <label>D√≠a</label>
            <select id="r_dia"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select>
        </div>
        <div class="input-group">
            <label>Nombre</label>
            <input id="r_nombre" placeholder="Ej: Dominadas">
        </div>
        <div class="input-group">
            <label>Series / Reps</label>
            <input id="r_series" placeholder="Ej: 3x Max">
        </div>
        <div class="input-group">
            <label>Imagen</label>
            <input type="file" id="r_file" accept="image/*">
        </div>
        <button class="btn btn-main" onclick="agregarEjercicio()">A√±adir a la lista</button>
    </div>
</section>

<section id="dieta">
    <div class="card" id="macros-calc">
        <h3>üî• Calculadora de Macros</h3>
        <input type="number" id="m_peso" placeholder="Tu peso actual (kg)" style="margin-bottom:10px">
        <select id="m_objetivo">
            <option value="mantener">Mantener Peso</option>
            <option value="volumen">Subir Volumen (Bulk)</option>
            <option value="definir">Definici√≥n (Cut)</option>
        </select>
        <button class="btn btn-main" style="margin-top:10px" onclick="calcularMacros()">Calcular Mis Macros</button>
        <div id="macro-res" style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-top:15px"></div>
    </div>

    <div id="menuHoyBox"></div>

    <div class="card">
        <h3>ü•ó Editar Men√∫s</h3>
        <div style="display:flex; gap:10px; margin-bottom:15px">
            <button class="btn btn-ghost" style="flex:1" onclick="tabDieta('A')">Men√∫ A</button>
            <button class="btn btn-ghost" style="flex:1" onclick="tabDieta('B')">Men√∫ B</button>
        </div>
        <div id="dieta-form">
            <h4 id="dieta-title">Editando Men√∫ A</h4>
            <input id="in_des" placeholder="Desayuno" style="margin-bottom:8px">
            <input id="in_co" placeholder="Comida" style="margin-bottom:8px">
            <input id="in_ce" placeholder="Cena" style="margin-bottom:8px">
            <button class="btn btn-main" onclick="guardarDieta()">Guardar Men√∫</button>
        </div>
    </div>
</section>

<section id="progreso">
    <div class="card">
        <h3>üìè Registrar Medidas</h3>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
            <input type="number" id="ev_peso" placeholder="Peso (kg)">
            <input type="number" id="ev_cintura" placeholder="Cintura (cm)">
        </div>
        <button class="btn btn-main" style="margin-top:10px" onclick="guardarProgreso()">Registrar Hoy</button>
    </div>
    <div class="card table-wrap">
        <table id="tabla-progreso">
            <thead><tr><th>Fecha</th><th>Peso</th><th>Cintura</th><th>Acci√≥n</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>
</section>

<section id="ajustes">
    <div class="card">
        <h3>üíæ Mis Datos</h3>
        <button class="btn btn-ghost" style="width:100%; margin-bottom:10px" onclick="exportarData()">üì§ Exportar Backup</button>
        <button class="btn btn-ghost" style="width:100%; margin-bottom:10px" onclick="document.getElementById('importInput').click()">üì• Importar Backup</button>
        <input type="file" id="importInput" style="display:none" onchange="importarData(event)">
        <button class="btn btn-main" style="background:var(--danger)" onclick="resetData()">‚ö†Ô∏è Borrar Todo</button>
    </div>
</header>

<div id="timer-pill">Descanso: <span id="time">60</span>s</div>

<script>
let DB = {
    rutinas: { "1": [], "2": [], "3": [], "4": [], "5": [], "6": [] },
    dieta: { menuA: {}, menuB: {}, plan: {} },
    progreso: []
};

function save() { localStorage.setItem('MONOS_FIT_LIGHT', JSON.stringify(DB)); }
function load() {
    const data = localStorage.getItem('MONOS_FIT_LIGHT');
    if(data) DB = JSON.parse(data);
    else { for(let i=1; i<=28; i++) DB.dieta.plan[i] = (i%2===0)?'B':'A'; save(); }
}

// --- FRASES ---
const frases = ["¬°Vamos con todo hoy!", "Tu cuerpo es tu templo.", "La disciplina vence al talento.", "Crea la mejor versi√≥n de ti.", "Entrenar es amarse a uno mismo."];
function nuevaFrase() {
    const el = document.getElementById('frase-container');
    el.style.opacity = 0;
    setTimeout(() => {
        el.innerText = frases[Math.floor(Math.random()*frases.length)];
        el.style.opacity = 1;
    }, 500);
}

// --- NAVEGACI√ìN ---
document.querySelectorAll('nav button').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.section).classList.add('active');
        if(btn.dataset.section === 'entrenar') renderEntrenamiento();
        if(btn.dataset.section === 'dieta') renderDieta();
        if(btn.dataset.section === 'progreso') renderProgreso();
    });
});

// --- RUTINA ---
function agregarEjercicio() {
    const dia = document.getElementById('r_dia').value;
    const nombre = document.getElementById('r_nombre').value;
    const series = document.getElementById('r_series').value;
    const file = document.getElementById('r_file').files[0];

    if(!nombre) return alert("Nombre obligatorio");

    const reader = new FileReader();
    reader.onload = (e) => {
        DB.rutinas[dia].push({ nombre, series, img: e.target.result || '', done: false });
        save(); alert("¬°A√±adido!");
        document.getElementById('r_nombre').value = '';
    };
    if(file) reader.readAsDataURL(file); else reader.onload({});
}

function renderEntrenamiento() {
    const dia = document.getElementById('selectDiaHoy').value;
    const cont = document.getElementById('listaEntrenamiento');
    cont.innerHTML = '';
    
    if(!DB.rutinas[dia] || DB.rutinas[dia].length === 0) {
        cont.innerHTML = "<p style='text-align:center; color:#94a3b8'>No hay ejercicios para este d√≠a.</p>";
        return;
    }

    DB.rutinas[dia].forEach((ej, idx) => {
        const div = document.createElement('div');
        div.className = 'ex-card';
        div.innerHTML = `
            <img src="${ej.img}" class="ex-img" onerror="this.style.display='none'">
            <div style="flex:1">
                <div style="font-weight:700">${ej.nombre}</div>
                <div style="font-size:0.8rem; color:var(--text-light)">${ej.series}</div>
            </div>
            <input type="checkbox" style="width:25px; height:25px" ${ej.done?'checked':''} onchange="toggleEj(${dia}, ${idx})">
            <button onclick="eliminarEj(${dia}, ${idx})" style="border:none; background:none; cursor:pointer">üóëÔ∏è</button>
        `;
        cont.appendChild(div);
    });
}

function toggleEj(dia, idx) {
    DB.rutinas[dia][idx].done = !DB.rutinas[dia][idx].done;
    if(DB.rutinas[dia][idx].done) startTimer();
    save();
    // No hacemos renderEntrenamiento() aqu√≠ para que no se "muevan" las cosas mientras entrenas
}

function eliminarEj(dia, idx) {
    if(confirm("¬øBorrar?")) { DB.rutinas[dia].splice(idx,1); save(); renderEntrenamiento(); }
}

// --- TIMER ---
function startTimer() {
    const pill = document.getElementById('timer-pill');
    const time = document.getElementById('time');
    let s = 60;
    pill.style.display = 'block';
    const inv = setInterval(() => {
        s--; time.innerText = s;
        if(s <= 0) { clearInterval(inv); pill.style.display = 'none'; }
    }, 1000);
}

// --- DIETA & MACROS ---
let dietTab = 'A';
function tabDieta(t) {
    dietTab = t; document.getElementById('dieta-title').innerText = `Editando Men√∫ ${t}`;
    const m = DB.dieta[`menu${t}`];
    document.getElementById('in_des').value = m.des || '';
    document.getElementById('in_co').value = m.co || '';
    document.getElementById('in_ce').value = m.ce || '';
}

function guardarDieta() {
    DB.dieta[`menu${dietTab}`] = {
        des: document.getElementById('in_des').value,
        co: document.getElementById('in_co').value,
        ce: document.getElementById('in_ce').value
    };
    save(); renderDieta(); alert("Guardado");
}

function calcularMacros() {
    const peso = document.getElementById('m_peso').value;
    const obj = document.getElementById('m_objetivo').value;
    if(!peso) return;
    
    let cals = peso * 30;
    if(obj === 'volumen') cals += 400;
    if(obj === 'definir') cals -= 400;

    const prot = peso * 2;
    const fats = peso * 0.8;
    const carbs = (cals - (prot*4) - (fats*9)) / 4;

    document.getElementById('macro-res').innerHTML = `
        <div class="macro-box" style="background:var(--primary)"><b>${Math.round(prot)}g</b><br>Prote√≠na</div>
        <div class="macro-box" style="background:var(--accent)"><b>${Math.round(carbs)}g</b><br>Carbos</div>
        <div class="macro-box" style="background:var(--warning)"><b>${Math.round(fats)}g</b><br>Grasas</div>
    `;
}

function renderDieta() {
    const hoy = ((new Date().getDate()-1)%28)+1;
    const m = DB.dieta[`menu${DB.dieta.plan[hoy]}`];
    document.getElementById('menuHoyBox').innerHTML = `
        <div class="card" style="border-left: 5px solid var(--accent)">
            <h3 style="margin:0">üçΩÔ∏è Men√∫ de Hoy (D√≠a ${hoy} - ${DB.dieta.plan[hoy]})</h3>
            <p style="font-size:0.9rem; color:var(--text-light)">
                üç≥ ${m.des || '---'} | ü•ó ${m.co || '---'} | üåô ${m.ce || '---'}
            </p>
        </div>
    `;
}

// --- PROGRESO ---
function guardarProgreso() {
    const peso = document.getElementById('ev_peso').value;
    const cint = document.getElementById('ev_cintura').value;
    if(!peso) return;
    DB.progreso.unshift({ fecha: new Date().toLocaleDateString(), peso, cint });
    save(); renderProgreso();
}

function renderProgreso() {
    const body = document.querySelector('#tabla-progreso tbody');
    body.innerHTML = '';
    DB.progreso.forEach((p, i) => {
        body.innerHTML += `<tr><td>${p.fecha}</td><td>${p.peso}kg</td><td>${p.cint}cm</td><td><button onclick="borrarP(${i})">‚ùå</button></td></tr>`;
    });
}
function borrarP(i) { DB.progreso.splice(i,1); save(); renderProgreso(); }

// --- BACKUP ---
function exportarData() {
    const blob = new Blob([JSON.stringify(DB)], {type: 'application/json'});
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'monos_fit_lite.json'; a.click();
}

function importarData(e) {
    const reader = new FileReader();
    reader.onload = (ev) => { DB = JSON.parse(ev.target.result); save(); location.reload(); };
    reader.readAsText(e.target.files[0]);
}

function resetData() { if(confirm("¬øBorrar todo?")) { localStorage.clear(); location.reload(); } }

// INIT
load();
nuevaFrase();
renderEntrenamiento();
setInterval(nuevaFrase, 10000);
</script>

</body>
</html>

