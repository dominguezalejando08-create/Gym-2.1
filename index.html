<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MONOS FIT | Personal Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

        :root {
            /* Colores por defecto (se cambian din√°micamente) */
            --primary: #9d4edd; 
            --accent: #ff85a1; 
            --bg: #fff5f8; 
            --card: #ffffff;
            --text: #4a1e4a; 
            --text-light: #8e7d8e;
            --shadow: 0 10px 30px rgba(0,0,0,0.05);
            --radius: 24px;
        }

        /* --- TEMAS --- */
        .tema-ni√±a {
            --primary: #9d4edd; --accent: #ff85a1; --bg: #fff5f8; --text: #4a1e4a;
            --gradient: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
        }

        .tema-ni√±o {
            --primary: #2563eb; --accent: #22c55e; --bg: #0f172a; --card: #1e293b;
            --text: #f8fafc; --text-light: #94a3b8;
            --gradient: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        }

        body {
            margin: 0; font-family: 'Poppins', sans-serif;
            background-color: var(--bg); color: var(--text);
            padding-bottom: 80px; transition: 0.3s;
        }

        /* --- Selector Inicial --- */
        #pantalla-inicio {
            position: fixed; inset: 0; background: #fff; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; text-align: center;
        }
        .btn-selector {
            padding: 20px 40px; margin: 10px; border-radius: 20px; border: none;
            font-size: 1.2rem; font-weight: 700; cursor: pointer; width: 250px; color: white;
        }

        /* --- Header --- */
        header {
            padding: 50px 20px; text-align: center;
            background: var(--gradient, #eee); color: white;
            border-bottom-left-radius: 40px; border-bottom-right-radius: 40px;
            box-shadow: var(--shadow);
        }
        header h1 { margin: 0; font-size: 2rem; }

        /* --- Nav --- */
        nav {
            display: flex; background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px); position: sticky; top: 0; z-index: 1000;
            justify-content: space-around; border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .tema-ni√±o nav { background: rgba(30, 41, 59, 0.8); }
        nav button {
            border: none; background: none; padding: 18px 10px;
            font-weight: 600; font-size: 0.8rem; color: var(--text-light); cursor: pointer;
        }
        nav button.active { color: var(--primary); border-bottom: 3px solid var(--primary); }

        /* --- Cards & Layout --- */
        section { display: none; max-width: 600px; margin: 30px auto; padding: 0 20px; animation: fadeIn 0.4s; }
        section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card {
            background: var(--card); border-radius: var(--radius);
            padding: 25px; margin-bottom: 25px; box-shadow: var(--shadow);
        }

        .ex-card {
            display: flex; align-items: center; gap: 15px; padding: 15px;
            background: var(--card); border-radius: 18px; margin-bottom: 12px;
            border: 1px solid rgba(0,0,0,0.05);
        }
        .ex-img { width: 65px; height: 65px; border-radius: 15px; object-fit: cover; background: #eee; }

        /* --- Buttons --- */
        .btn { padding: 14px; border-radius: 18px; border: none; font-weight: 600; cursor: pointer; width: 100%; transition: 0.2s; }
        .btn-main { background: var(--primary); color: white; }
        .btn-accent { background: var(--accent); color: white; margin-top: 10px; }

        input, select {
            width: 100%; padding: 12px; border-radius: 15px; border: 2px solid rgba(0,0,0,0.1);
            margin-bottom: 15px; box-sizing: border-box; background: var(--card); color: var(--text);
        }

        #timer-box {
            position: fixed; bottom: 25px; right: 25px; background: var(--card);
            border: 2px solid var(--primary); padding: 15px 25px;
            border-radius: 50px; font-weight: 700; color: var(--primary); display: none;
        }
    </style>
</head>
<body class="tema-ni√±a">

<div id="pantalla-inicio">
    <h1>üêµ ¬°Bienvenido a MONOS FIT!</h1>
    <p>¬øQui√©n va a entrenar hoy?</p>
    <button class="btn-selector" style="background:#ff85a1" onclick="elegirTema('ni√±a')">Soy Ni√±a üå∏</button>
    <button class="btn-selector" style="background:#2563eb" onclick="elegirTema('ni√±o')">Soy Ni√±o ‚ö°</button>
</div>

<header>
    <h1 id="titulo-header">MONOS FIT</h1>
    <div id="frase-container">Cargando motivaci√≥n...</div>
</header>

<nav>
    <button class="active" data-section="entrenar">HOY</button>
    <button data-section="rutina">PLAN</button>
    <button data-section="dieta">DIETA</button>
    <button data-section="progreso">EVO</button>
    <button data-section="ajustes">GEAR</button>
</nav>

<section id="entrenar" class="active">
    <h2>‚ú® Rutina de Hoy</h2>
    <select id="selectDiaHoy" onchange="renderEntrenamiento()">
        <option value="1">Lunes - D√≠a 1</option><option value="2">Martes - D√≠a 2</option>
        <option value="3">Mi√©rcoles - D√≠a 3</option><option value="4">Jueves - D√≠a 4</option>
        <option value="5">Viernes - D√≠a 5</option><option value="6">S√°bado - D√≠a 6</option>
    </select>
    <div id="listaEntrenamiento"></div>
</section>

<section id="rutina">
    <div class="card">
        <h2>üìù A√±adir Ejercicio</h2>
        <select id="r_dia"><option value="1">D√≠a 1</option><option value="2">D√≠a 2</option><option value="3">D√≠a 3</option><option value="4">D√≠a 4</option><option value="5">D√≠a 5</option><option value="6">D√≠a 6</option></select>
        <input id="r_nombre" placeholder="Nombre (ej. Press Militar)">
        <input id="r_series" placeholder="Series/Reps">
        <input type="file" id="r_file" accept="image/*">
        <button class="btn btn-main" onclick="agregarEjercicio()">Guardar Ejercicio</button>
    </div>
</section>

<section id="dieta">
    <div class="card">
        <h2>‚öñÔ∏è Macros</h2>
        <input type="number" id="m_peso" placeholder="Peso actual (kg)">
        <button class="btn btn-main" onclick="calcularMacros()">Calcular</button>
        <div id="macro-res" style="display:flex; gap:10px; margin-top:15px"></div>
    </div>
    <div id="menuHoyBox"></div>
    <div class="card">
        <h2>üç≥ Men√∫s Base</h2>
        <input id="in_des" placeholder="Desayuno">
        <input id="in_co" placeholder="Almuerzo">
        <input id="in_ce" placeholder="Cena">
        <button class="btn btn-accent" onclick="guardarDieta()">Guardar Men√∫</button>
    </div>
</section>

<section id="progreso">
    <div class="card">
        <h2>üìâ Registro</h2>
        <input type="number" id="ev_peso" placeholder="Peso (kg)">
        <button class="btn btn-main" onclick="guardarProgreso()">Registrar</button>
    </div>
    <div id="historial-lista"></div>
</section>

<section id="ajustes">
    <div class="card">
        <h2>‚öôÔ∏è Configuraci√≥n</h2>
        <button class="btn btn-main" style="margin-bottom:10px" onclick="exportarData()">üì§ Exportar Backup</button>
        <button class="btn btn-accent" onclick="document.getElementById('importInput').click()">üì• Importar Backup</button>
        <input type="file" id="importInput" style="display:none" onchange="importarData(event)">
        <hr style="margin:20px 0; opacity:0.1">
        <button class="btn" style="background:#94a3b8; color:white" onclick="reiniciarPerfil()">üîÑ Cambiar Perfil (Ni√±o/Ni√±a)</button>
        <button class="btn" style="margin-top:10px; background:#ef4444; color:white" onclick="resetData()">Eliminar todo</button>
    </div>
</section>

<div id="timer-box">‚è±Ô∏è <span id="time">60</span>s</div>

<script>
let DB = {
    tema: null,
    rutinas: { "1": [], "2": [], "3": [], "4": [], "5": [], "6": [] },
    dieta: { menuA: {}, menuB: {}, plan: {} },
    progreso: []
};

function save() { localStorage.setItem('MONOS_FIT_V4', JSON.stringify(DB)); }
function load() {
    const data = localStorage.getItem('MONOS_FIT_V4');
    if(data) {
        DB = JSON.parse(data);
        if(DB.tema) aplicarTema(DB.tema);
    } else {
        for(let i=1; i<=28; i++) DB.dieta.plan[i] = (i%2===0)?'B':'A';
    }
}

function elegirTema(t) {
    DB.tema = t;
    aplicarTema(t);
    save();
}

function aplicarTema(t) {
    document.body.className = 'tema-' + t;
    document.getElementById('pantalla-inicio').style.display = 'none';
    document.getElementById('titulo-header').innerText = t === 'ni√±a' ? 'MONOS FIT üå∏' : 'MONOS FIT ‚ö°';
}

function reiniciarPerfil() {
    if(confirm("¬øQuieres volver a elegir entre Ni√±o o Ni√±a?")) {
        document.getElementById('pantalla-inicio').style.display = 'flex';
    }
}

// --- NAVEGACI√ìN ---
document.querySelectorAll('nav button').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.section).classList.add('active');
        if(btn.dataset.section === 'entrenar') renderEntrenamiento();
        if(btn.dataset.section === 'dieta') renderDieta();
        if(btn.dataset.section === 'progreso') renderProgreso();
    });
});

// --- FUNCIONES (L√≥gica sin contracci√≥n) ---
function renderEntrenamiento() {
    const dia = document.getElementById('selectDiaHoy').value;
    const cont = document.getElementById('listaEntrenamiento');
    cont.innerHTML = '';
    DB.rutinas[dia].forEach((ej, idx) => {
        const div = document.createElement('div');
        div.className = 'ex-card';
        div.innerHTML = `
            <img src="${ej.img}" class="ex-img" onerror="this.style.display='none'">
            <div style="flex:1">
                <div style="font-weight:600">${ej.nombre}</div>
                <div style="font-size:0.75rem; color:var(--text-light)">${ej.series}</div>
            </div>
            <input type="checkbox" style="width:25px; height:25px; accent-color:var(--primary)" ${ej.done?'checked':''} onchange="toggleEj(${dia}, ${idx})">
        `;
        cont.appendChild(div);
    });
}

function toggleEj(dia, idx) {
    DB.rutinas[dia][idx].done = !DB.rutinas[dia][idx].done;
    if(DB.rutinas[dia][idx].done) startTimer();
    save();
}

function startTimer() {
    const box = document.getElementById('timer-box');
    const time = document.getElementById('time');
    let s = 60; box.style.display = 'block';
    const inv = setInterval(() => {
        s--; time.innerText = s;
        if(s <= 0) { clearInterval(inv); box.style.display = 'none'; }
    }, 1000);
}

// --- RESTO DE L√ìGICA ---
function agregarEjercicio() {
    const dia = document.getElementById('r_dia').value;
    const nombre = document.getElementById('r_nombre').value;
    const series = document.getElementById('r_series').value;
    const file = document.getElementById('r_file').files[0];
    if(!nombre) return alert("Nombre obligatorio");
    const reader = new FileReader();
    reader.onload = (e) => {
        DB.rutinas[dia].push({ nombre, series, img: e.target.result || '', done: false });
        save(); alert("¬°Guardado!");
        document.getElementById('r_nombre').value = '';
    };
    if(file) reader.readAsDataURL(file); else reader.onload({});
}

function calcularMacros() {
    const peso = document.getElementById('m_peso').value;
    if(!peso) return;
    document.getElementById('macro-res').innerHTML = `
        <div style="flex:1; background:var(--primary); color:white; padding:10px; border-radius:10px; text-align:center"><b>${peso*2}g</b><br>Prot</div>
        <div style="flex:1; background:var(--accent); color:white; padding:10px; border-radius:10px; text-align:center"><b>${peso*0.8}g</b><br>Grasa</div>
    `;
}

function renderDieta() {
    const hoy = ((new Date().getDate()-1)%28)+1;
    const m = DB.dieta.menuA;
    document.getElementById('menuHoyBox').innerHTML = `<div class="card"><h2>üç¥ Men√∫ del D√≠a</h2><p>${m.des || '---'}<br>${m.co || '---'}<br>${m.ce || '---'}</p></div>`;
}

function guardarDieta() {
    DB.dieta.menuA = { des: document.getElementById('in_des').value, co: document.getElementById('in_co').value, ce: document.getElementById('in_ce').value };
    save(); renderDieta(); alert("Men√∫ guardado");
}

function guardarProgreso() {
    const peso = document.getElementById('ev_peso').value;
    if(!peso) return;
    DB.progreso.unshift({ fecha: new Date().toLocaleDateString(), peso });
    save(); renderProgreso();
}

function renderProgreso() {
    const cont = document.getElementById('historial-lista');
    cont.innerHTML = '';
    DB.progreso.forEach((p, i) => {
        cont.innerHTML += `<div class="card" style="display:flex; justify-content:space-between"><div><b>${p.fecha}</b>: ${p.peso}kg</div><button onclick="DB.progreso.splice(${i},1); save(); renderProgreso();">üóëÔ∏è</button></div>`;
    });
}

function exportarData() {
    const blob = new Blob([JSON.stringify(DB)], {type: 'application/json'});
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
    a.download = 'backup_fit.json'; a.click();
}

function importarData(e) {
    const reader = new FileReader();
    reader.onload = (ev) => { DB = JSON.parse(ev.target.result); save(); location.reload(); };
    reader.readAsText(e.target.files[0]);
}

function resetData() { if(confirm("¬øBorrar todo?")) { localStorage.clear(); location.reload(); } }

// INIT
load();
document.getElementById('frase-container').innerText = "¬°A darle con todo!";
renderEntrenamiento();
</script>
</body>
</html>
